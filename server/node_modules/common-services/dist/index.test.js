"use strict";

var _assert = _interopRequireDefault(require("assert"));

var _fs = _interopRequireDefault(require("fs"));

var _path = _interopRequireDefault(require("path"));

var services = _interopRequireWildcard(require("./index"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

describe('index', () => {
  let files;
  beforeAll(done => {
    _fs.default.readdir(__dirname, (err, _files_) => {
      if (err) {
        done(err);
        return;
      }

      files = _files_;
      done();
    });
  });
  test('should import all services of the src folder', done => {
    Promise.all(files.filter(file => !['.', '..', 'index.ts'].includes(file)).filter(file => !file.endsWith('.test.ts')).filter(file => file !== '__snapshots__').filter(file => !file.endsWith('.d.ts')).filter(file => !file.endsWith('.mock.ts')).map(file => require(_path.default.join(__dirname, file)).default) // eslint-disable-line
    ).then(modules => {
      _assert.default.deepEqual(Object.keys(services).sort().map(name => name.replace(/^init(.*)Service$/, 'init$1')), modules.map(module => module.name).map(name => name.replace(/(bound )*/, '')) // Also exports LogService defaults/interfaces
      .concat(['DEFAULT_LOGGER', 'DEFAULT_LOG_ROUTING']).sort());
    }).then(() => done()).catch(done);
  });
});
//# sourceMappingURL=index.test.js.map